<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image to PDF</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body {
    margin: 0;
    padding: 20px;
    font-family: 'Kanit', sans-serif;
    background: linear-gradient(135deg, #f0fff0, #e6f7ff);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    box-sizing: border-box;
    position: relative;
  }

  .logo-container { text-align: center; margin-bottom: 20px; }
  .logo-container img { width: 100px; height: auto; margin-bottom: 10px; }
  .logo-container h3 { color:#06C755; font-weight:700; margin:0; font-size:1.5rem; }
  h1 { color:#06C755; font-weight:700; margin-bottom:20px; text-align:center; }

  input[type=file] {
    width: 100%; max-width:400px; padding:15px; margin-bottom:15px;
    border:1.5px solid #ccc; border-radius:12px; font-size:1rem; background:#fff;
    outline:none; cursor:pointer; transition:.3s;
  }
  input[type=file]:focus { border-color:#06C755; box-shadow:0 0 8px rgba(6,199,85,.3); }

  .btn {
    width:100%; max-width:400px; padding:15px; border:none; border-radius:12px;
    background-color:#06C755; color:#fff; font-size:1.2rem; font-weight:700;
    cursor:pointer; margin-top:10px; text-align:center; transition:.3s;
  }
  .btn:hover { background-color:#049645; transform:translateY(-2px); }

  #result { text-align:center; font-size:1.2rem; font-weight:700; margin-top:15px; }
  .success { color: green; }
  .error { color: red; }

  footer { margin-top:30px; font-size:0.85rem; color:#666; text-align:center; }
  footer a { color:#3768fa; text-decoration:none; margin:0 5px; }
  footer a:hover { text-decoration:underline; }

  /* Floating Buttons */
  .floating-btn {
    position: fixed; bottom:20px; right:20px; width:55px; height:55px;
    border-radius:50%; background-color:#06C755; color:#fff; display:flex;
    justify-content:center; align-items:center; font-size:1.6rem; cursor:pointer;
    box-shadow:0 5px 15px rgba(0,0,0,0.3); transition:.3s; z-index:1000;
  }
  .floating-btn:hover { background-color:#049645; transform:translateY(-3px); }

  /* Share submenu */
  .share-submenu {
    position: fixed; bottom:85px; right:20px; display:flex; flex-direction:column;
    gap:12px; display:none;
  }
  .share-submenu a {
    width:45px; height:45px; border-radius:50%; color:#fff; display:flex;
    justify-content:center; align-items:center; text-decoration:none; font-weight:bold;
    font-size:1.2rem; box-shadow:0 3px 10px rgba(0,0,0,.2); transition:.3s;
  }
  .share-facebook { background:#3b5998; }
  .share-twitter { background:#1da1f2; }
  .share-line { background:#00c300; }
  .share-submenu a:hover { opacity:0.85; transform:scale(1.1); }
</style>
</head>
<body>

<div class="logo-container">
  <img src="https://cdn-icons-png.flaticon.com/512/281/281769.png" alt="Logo">
  <h3>Image to PDF Converter</h3>
</div>

<h1>üì∑ ‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏õ‡πá‡∏ô PDF</h1>

<!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå -->
<input type="file" id="images" accept="image/*" multiple>
<button class="btn" onclick="makePDF()">‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô PDF</button>

<div id="result"></div>

<footer>
  ¬© 2025 My Project | <a href="https://github.com/sekartwork-creator" target="_blank">GitHub</a>
</footer>

<!-- Scanner Floating Button -->
<div id="scannerBtn" class="floating-btn" title="Scanner">üì∑</div>
<input type="file" id="cameraScan" accept="image/*" capture="environment" style="display:none;">

<!-- Share Submenu -->
<div class="share-submenu" id="shareMenu">
  <a href="#" target="_blank" class="share-facebook" id="shareFb" title="Facebook">F</a>
  <a href="#" target="_blank" class="share-twitter" id="shareTw" title="Twitter">T</a>
  <a href="#" target="_blank" class="share-line" id="shareLine" title="Line">L</a>
</div>

<script>
const { jsPDF } = window.jspdf;
let imageFiles = [];

// ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
document.getElementById('images').addEventListener('change', e => {
  imageFiles = Array.from(e.target.files);
});

// Scanner
document.getElementById('scannerBtn').addEventListener('click', () => {
  document.getElementById('cameraScan').click();
});
document.getElementById('cameraScan').addEventListener('change', e => {
  imageFiles = Array.from(e.target.files);
});

// ‡πÅ‡∏õ‡∏•‡∏á PDF + ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î Google Drive
async function uploadPDFToDrive(pdfBlob) {
  const reader = new FileReader();
  return new Promise((resolve, reject) => {
    reader.onload = async function() {
      try {
        const base64data = reader.result;
        const response = await fetch('https://script.google.com/macros/s/AKfycbwIe0tbe3NPc0CTy162Zr1vEQc8ZKNYFlenQn7ryNsQgLoSYZEzQ3nnBYRV0ln_ZWNkrA/exec', {
          method: 'POST',
          body: base64data
        });
        const result = await response.json();
        resolve(result.url);
      } catch(err) { reject(err); }
    };
    reader.readAsDataURL(pdfBlob);
  });
}

async function makePDF() {
  if (imageFiles.length === 0) {
    document.getElementById('result').innerHTML = "<span class='error'>‚ö† ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞</span>";
    document.getElementById('shareMenu').style.display = 'none';
    return;
  }

  const pdf = new jsPDF();
  for (let i=0; i<imageFiles.length; i++){
    const imgData = await toBase64(imageFiles[i]);
    const img = new Image();
    img.src = imgData;
    await new Promise(res => img.onload = res);

    let width = pdf.internal.pageSize.getWidth();
    let height = (img.height * width) / img.width;
    if(i>0) pdf.addPage();
    pdf.addImage(img, "JPEG", 0, 0, width, height);
  }

  const pdfBlob = pdf.output("blob");
  const driveUrl = await uploadPDFToDrive(pdfBlob);

  // ‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
  document.getElementById('result').innerHTML =
    <a href="${driveUrl}" target="_blank" class='success'>üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF</a>;

  // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ä‡∏£‡πå
  const shareMenu = document.getElementById('shareMenu');
  shareMenu.style.display = 'flex';
  document.getElementById('shareFb').href = https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(driveUrl)};
  document.getElementById('shareTw').href = https://twitter.com/intent/tweet?url=${encodeURIComponent(driveUrl)}&text=${encodeURIComponent('‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏π‡∏õ‡πÄ‡∏õ‡πá‡∏ô PDF!')};
  document.getElementById('shareLine').href = https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(driveUrl)};
}

function toBase64(file){
  return new Promise((resolve,reject)=>{
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = ()=>resolve(reader.result);
    reader.onerror = error=>reject(error);
  });
}
</script>
</body>
</html>
