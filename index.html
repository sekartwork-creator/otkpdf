<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Document Scanner</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.8.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
<style>
  body { font-family:'Sarabun',sans-serif; text-align:center; padding:20px; background:#f5f5f5; }
  canvas { border:1px solid #ccc; margin-top:10px; max-width:100%; border-radius:8px; }
  input, button { padding:10px 20px; margin:10px; border-radius:6px; font-size:16px; }
</style>
</head>
<body>
<h2>üìÑ AI Document Scanner (Free)</h2>
<p>‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‚Üí ‡∏Ñ‡∏£‡∏≠‡∏õ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‚Üí ‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</p>

<input type="file" accept="image/*" capture="environment" id="cameraInput">
<canvas id="canvas"></canvas>

<script>
let model;
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

// ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• COCO-SSD
cocoSsd.load().then(m => {
  model = m;
  console.log("AI model loaded");
});

document.getElementById('cameraInput').addEventListener('change', async e => {
  if(e.target.files.length===0) return;
  const file = e.target.files[0];
  const img = new Image();
  img.src = URL.createObjectURL(file);
  img.onload = async () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    // ‡πÉ‡∏ä‡πâ AI detect object "book" ‡∏´‡∏£‡∏∑‡∏≠ "document" (approach ‡πÅ‡∏ö‡∏ö demo)
    if(model){
      const predictions = await model.detect(img);
      let doc = predictions.find(p => p.class==="book" || p.class==="document");
      if(doc){
        const {bbox} = doc; // [x, y, width, height]
        const [x,y,w,h] = bbox;
        const cropped = ctx.getImageData(x,y,w,h);
        canvas.width = w;
        canvas.height = h;
        ctx.putImageData(cropped,0,0);
      }
    }
  }
});
</script>
</body>
</html>
